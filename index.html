<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forwarder Venture - Tecnolog√≠a y Hogar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap');
        body { background-color: #F3F4F6; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        .text-fv-blue { color: #002e5f; }
        .bg-fv-blue { background-color: #002e5f; }
        .text-fv-orange { color: #e85d04; }
        .bg-fv-orange { background-color: #e85d04; }
        .accent-fv { accent-color: #e85d04; }
        
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .price-active { background-color: #e85d04; color: white !important; transform: scale(1.02); padding-left: 8px; padding-right: 8px; border-radius: 4px; font-weight: 900 !important; }
        .price-active span { color: white !important; }

        .variant-btn { border: 1px solid #e2e8f0; padding: 8px 16px; border-radius: 6px; font-size: 12px; font-weight: 700; text-transform: uppercase; transition: all 0.2; background: white; color: #4b5563; cursor: pointer; }
        .variant-btn:hover { border-color: #002e5f; background-color: #f9fafb; }
        .variant-btn.active { border-color: #002e5f; background-color: #002e5f; color: white; }
    </style>
</head>
<body class="min-h-screen relative text-gray-900">

    <div class="max-w-[1400px] mx-auto bg-white min-h-screen shadow-2xl relative flex flex-col">

        <header class="bg-white/95 backdrop-blur-md px-5 py-3 sticky top-0 z-50 flex justify-between items-center border-b border-gray-100 shadow-sm h-[80px]">
            <div class="flex items-center">
                <img src="logo.png" alt="Forwarder Venture" class="w-[120px] object-contain">
            </div>
            <button onclick="toggleCart()" class="relative p-2 active:scale-95 transition-transform hover:bg-gray-100 rounded-full">
                <i class="fa-solid fa-cart-shopping text-2xl text-fv-blue"></i>
                <span id="cart-count" class="absolute top-0 right-0 bg-orange-600 text-white text-[10px] font-bold h-5 w-5 flex items-center justify-center rounded-full border-2 border-white">0</span>
            </button>
        </header>

        <section class="relative w-full h-[30vh] md:h-[40vh] bg-fv-blue overflow-hidden flex items-end p-6 md:p-12">
            <img src="https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=2070&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-50" alt="Tecnolog√≠a y Hogar">
            <div class="absolute inset-0 bg-gradient-to-t from-fv-blue/90 via-fv-blue/30 to-transparent"></div>
            <div class="relative z-10 w-full">
                <span class="bg-orange-600 text-white px-3 py-1 font-black text-xs md:text-sm uppercase tracking-widest mb-3 inline-block rounded-sm shadow-sm">Cat√°logo de Productos</span>
                <h2 class="text-white font-black text-3xl md:text-5xl leading-none mb-2 drop-shadow-md">TECNOLOG√çA<br>& HOGAR</h2>
                <p class="text-gray-100 text-sm md:text-base font-medium max-w-md drop-shadow">Innovaci√≥n y soluciones pr√°cticas para tu espacio.</p>
            </div>
        </section>

        <div class="sticky top-[80px] z-40 bg-white shadow-sm border-b border-gray-200">
            <nav id="category-nav" class="flex overflow-x-auto gap-3 px-5 py-4 hide-scrollbar"></nav>
            <div class="px-5 py-3 bg-gray-50/80 backdrop-blur-sm flex flex-col md:flex-row gap-4 justify-between items-center text-sm">
                <div class="flex items-center gap-2 w-full md:w-auto">
                    <i class="fa-solid fa-magnifying-glass text-gray-400"></i>
                    <input type="text" id="search-input" placeholder="Buscar producto..." class="bg-white border border-gray-300 text-xs rounded-lg p-2 w-full md:w-64 outline-none focus:ring-1 focus:ring-fv-blue" oninput="applyFilters()">
                </div>
                <div class="flex items-center gap-3 w-full md:w-auto">
                    <span class="text-xs font-bold text-gray-500 whitespace-nowrap"><i class="fa-solid fa-filter-circle-dollar mr-1"></i>Precio M√°x:</span>
                    <input type="range" id="price-range" min="0" max="1000000" step="5000" class="w-full accent-fv h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" oninput="updatePriceLabel(this.value); applyFilters()">
                    <span id="price-label" class="text-xs font-black text-fv-blue min-w-[90px] text-right bg-white px-2 py-1 rounded border border-gray-100">$0</span>
                </div>
            </div>
        </div>

        <main class="p-4 md:p-10 bg-gray-50 pb-20 flex-grow">
            <div id="product-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-8">
                <div class="col-span-full flex flex-col items-center justify-center py-32 text-gray-400">
                    <i class="fa-solid fa-circle-notch fa-spin text-4xl mb-4 text-fv-blue"></i>
                    <p class="text-base font-bold uppercase tracking-widest">Cargando cat√°logo...</p>
                </div>
            </div>
        </main>

        <footer class="bg-gray-900 text-white py-12 border-t-4 border-orange-600 mt-auto">
            <div class="flex flex-col items-center justify-center text-center px-6">
                <h3 class="font-black text-2xl tracking-tighter uppercase mb-2">FORWARDER VENTURE</h3>
                <p class="text-gray-400 text-xs mb-8 tracking-widest uppercase">Tecnolog√≠a y Hogar Inteligente</p>
                
                <div class="flex gap-6 mb-8">
                    <a href="https://wa.me/573202948443" target="_blank" class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center text-white text-xl hover:scale-110 transition shadow-lg">
                        <i class="fa-brands fa-whatsapp"></i>
                    </a>
                </div>
                
                <p class="text-orange-500 font-bold text-xs uppercase tracking-widest mb-4">* Precios sujetos a disponibilidad de inventario</p>
                <p class="text-gray-500 text-xs">&copy; 2026 Forwarder Venture. Todos los derechos reservados.</p>
            </div>
        </footer>

    </div>

    <div id="product-modal" class="hidden fixed inset-0 bg-black/80 z-[2000] flex items-center justify-center p-4 backdrop-blur-sm transition-opacity opacity-0">
        <div class="bg-white w-full max-w-4xl rounded-2xl overflow-hidden shadow-2xl relative transform transition-all scale-95 flex flex-col md:flex-row max-h-[90vh] md:h-auto" id="product-modal-content">
            <button onclick="closeProductModal()" class="absolute top-4 right-4 w-10 h-10 bg-black/10 hover:bg-black/20 rounded-full flex items-center justify-center z-10 transition">
                <i class="fa-solid fa-xmark text-xl text-gray-800"></i>
            </button>
            
            <div class="w-full md:w-1/2 bg-gray-50 p-6 flex flex-col items-center justify-center border-b md:border-b-0 md:border-r border-gray-200">
                <div class="w-full aspect-square flex items-center justify-center mb-4 bg-white rounded-xl shadow-sm border border-gray-100 p-2">
                    <img id="modal-img" src="" class="w-full h-full object-contain max-h-[350px]">
                </div>
            </div>
            
            <div class="w-full md:w-1/2 p-6 md:p-8 flex flex-col justify-between overflow-y-auto">
                <div>
                    <span id="modal-category" class="text-xs font-black text-orange-600 uppercase tracking-widest">CATEGOR√çA</span>
                    <h2 id="modal-title" class="text-2xl md:text-3xl font-black text-gray-900 leading-tight mt-1 mb-2">Nombre</h2>
                    <p class="text-gray-500 text-xs mb-4 font-mono bg-gray-50 inline-block px-2 py-1 rounded">SKU: <span id="modal-sku" class="font-bold text-gray-800"></span></p>
                    
                    <div id="variant-section" class="mb-6 hidden">
                        <label class="text-xs font-bold text-gray-400 uppercase mb-2 block">Selecciona opci√≥n:</label>
                        <div id="variant-container" class="flex flex-wrap gap-2"></div>
                    </div>

                    <div class="bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm">
                        <div class="flex justify-between items-center">
                             <span class="text-gray-600 font-bold">Precio Unitario:</span>
                             <span id="price-1" class="text-2xl font-black text-fv-blue"></span>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="text-xs font-bold text-gray-500 uppercase mb-2 block">Cantidad:</label>
                        <div class="flex items-center border-2 border-fv-blue rounded-xl h-14 overflow-hidden w-full max-w-[200px] shadow-sm">
                            <button onclick="updateModalInput(-1)" class="w-14 h-full bg-gray-50 hover:bg-gray-200 text-gray-600 font-bold text-2xl">-</button>
                            <input type="number" id="modal-qty-input" value="1" min="1" class="w-full h-full text-center font-black text-2xl border-none focus:ring-0 text-fv-blue bg-white">
                            <button onclick="updateModalInput(1)" class="w-14 h-full bg-gray-50 hover:bg-gray-200 text-gray-600 font-bold text-2xl">+</button>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-6 gap-2 mt-auto">
                    <button onclick="shareProductWhatsApp()" class="col-span-1 bg-green-500 text-white rounded-xl flex items-center justify-center hover:bg-green-600 transition h-14" title="Consultar por WhatsApp">
                        <i class="fa-brands fa-whatsapp text-2xl"></i>
                    </button>
                    <button id="modal-add-btn" class="col-span-5 bg-fv-blue text-white rounded-xl font-bold text-lg hover:opacity-90 transition flex items-center justify-center gap-2 shadow-lg h-14">
                        A√±adir al Carrito <i class="fa-solid fa-cart-plus"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="cart-modal" class="hidden fixed inset-0 bg-black/60 z-[3000] flex items-end md:items-center justify-center transition-opacity backdrop-blur-sm p-0 md:p-6">
        <div class="bg-white w-full md:max-w-xl h-[85vh] md:h-[80vh] rounded-t-3xl md:rounded-3xl flex flex-col overflow-hidden shadow-2xl relative">
            <div class="px-6 py-5 flex justify-between items-center border-b border-gray-100 bg-white">
                <h2 class="text-xl md:text-2xl font-black text-fv-blue">Tu Pedido</h2>
                <button onclick="toggleCart()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div id="cart-items" class="flex-grow p-5 md:p-8 overflow-y-auto space-y-4 bg-gray-50"></div>
            <div class="p-6 md:p-8 bg-white border-t border-gray-100">
                <div class="flex justify-between items-center mb-6">
                    <span class="text-gray-500 font-semibold uppercase text-sm">Subtotal:</span>
                    <span id="cart-total" class="text-3xl font-black text-fv-blue">$0</span>
                </div>
                <button onclick="sendToWhatsApp()" class="w-full bg-[#25D366] text-white py-4 rounded-2xl font-black text-lg flex justify-center items-center gap-3 shadow-lg hover:bg-[#128C7E] transition">
                    <i class="fa-brands fa-whatsapp text-2xl"></i> Confirmar por WhatsApp
                </button>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed top-24 left-1/2 transform -translate-x-1/2 bg-fv-blue text-white px-6 py-3 rounded-full shadow-2xl z-[4000] transition-all duration-300 opacity-0 translate-y-[-20px] pointer-events-none flex items-center gap-3 font-bold">
        <i class="fa-solid fa-check-circle text-orange-400 text-xl"></i> <span id="toast-msg">Mensaje</span>
    </div>

    <script>
        const WHATSAPP_NUMBER = '3202948443'; // Tu n√∫mero actualizado
        const SHEET_ID = '17a0Pxq1EOLRf86yiuM014ZluVqL2Qj1Mt8cKRDenjHc';
        const GID = '0'; // Hoja "Catalogo"
        const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${GID}`;

        let allProducts = [];
        let cart = [];
        let currentCategory = 'Ver Todo';
        let selectedProduct = null;
        let selectedVariant = null;

        function formatMoney(amount) {
            return amount.toLocaleString('es-CO', { style: 'currency', currency: 'COP', minimumFractionDigits: 0 });
        }

        function loadProducts() {
            Papa.parse(CSV_URL, {
                download: true, header: true, skipEmptyLines: true,
                complete: function(results) {
                    const tempGroups = {};
                    results.data.forEach((row) => {
                        const pSku = row['PARENT SKU']?.trim();
                        const sku = row['SKU']?.trim();
                        if(!sku) return;

                        const groupID = (pSku && pSku !== "") ? pSku : sku;

                        if (!tempGroups[groupID]) {
                            tempGroups[groupID] = {
                                id: groupID,
                                slug: (row['NOMBRE'] || 'prod').toLowerCase().replace(/[^a-z0-9]+/g, '-'),
                                nombre: row['NOMBRE'],
                                categoria: row['TIPO'] || 'General',
                                variaciones: []
                            };
                        }

                        const parsePrice = (v) => parseFloat(v?.toString().replace(/[^0-9.]/g, '')) || 0;
                        
                        tempGroups[groupID].variaciones.push({
                            sku: sku,
                            color: row['COLOR']?.trim() || '',
                            variable: row['VARIABLE']?.trim() || '',
                            img: row['IMAGEN']?.split(',')[0].trim() || 'https://via.placeholder.com/400',
                            price: parsePrice(row['PRECIO 1'])
                        });
                    });

                    allProducts = Object.values(tempGroups);
                    if(allProducts.length > 0) {
                        const maxP = Math.max(...allProducts.map(p => p.variaciones[0].price));
                        document.getElementById('price-range').max = maxP;
                        document.getElementById('price-range').value = maxP;
                        updatePriceLabel(maxP);
                        updateCategoryNav();
                        applyFilters();
                    }
                }
            });
        }

        function updateCategoryNav() {
            const uniqueCats = [...new Set(allProducts.map(p => p.categoria))];
            const categories = ['Ver Todo', ...uniqueCats.sort()];
            document.getElementById('category-nav').innerHTML = categories.map(cat => {
                const isActive = cat === currentCategory;
                return `<button onclick="filterCategory('${cat}')" class="px-5 py-2 rounded-full text-sm font-bold whitespace-nowrap border transition-all ${isActive ? 'bg-fv-blue text-white' : 'bg-white text-gray-600'}">${cat}</button>`;
            }).join('');
        }

        function filterCategory(cat) { 
            currentCategory = cat; 
            updateCategoryNav();
            applyFilters();
        }

        function applyFilters() {
            const maxP = parseInt(document.getElementById('price-range').value);
            const search = document.getElementById('search-input').value.toLowerCase();

            const filtered = allProducts.filter(p => {
                const matchCat = currentCategory === 'Ver Todo' || p.categoria === currentCategory;
                const matchPrice = p.variaciones[0].price <= maxP;
                const matchSearch = p.nombre.toLowerCase().includes(search);
                return matchCat && matchPrice && matchSearch;
            });

            renderProducts(filtered);
        }

        function renderProducts(products) {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = products.map(p => {
                const main = p.variaciones[0];
                return `
                    <div class="bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-all border border-gray-100 flex flex-col cursor-pointer" onclick="openProductModal('${p.id}')">
                        <div class="aspect-square p-4">
                            <img src="${main.img}" class="w-full h-full object-contain">
                        </div>
                        <div class="p-4 flex flex-col flex-grow">
                            <p class="text-[10px] text-orange-600 font-black uppercase mb-1">${p.categoria}</p>
                            <h3 class="font-bold text-sm text-gray-900 leading-tight line-clamp-2 mb-2">${p.nombre}</h3>
                            <div class="mt-auto flex justify-between items-center">
                                <span class="text-fv-blue font-black text-lg">${formatMoney(main.price)}</span>
                                <div class="w-8 h-8 bg-fv-blue text-white rounded-full flex items-center justify-center"><i class="fa-solid fa-plus"></i></div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function openProductModal(id) {
            selectedProduct = allProducts.find(p => p.id === id);
            selectedVariant = selectedProduct.variaciones[0];
            
            document.getElementById('modal-title').innerText = selectedProduct.nombre;
            document.getElementById('modal-category').innerText = selectedProduct.categoria;
            updateModalUI();

            const modal = document.getElementById('product-modal');
            modal.classList.remove('hidden');
            setTimeout(() => { modal.classList.remove('opacity-0'); }, 10);
        }

        function updateModalUI() {
            document.getElementById('modal-img').src = selectedVariant.img;
            document.getElementById('modal-sku').innerText = selectedVariant.sku;
            document.getElementById('price-1').innerText = formatMoney(selectedVariant.price);
            document.getElementById('modal-qty-input').value = 1;

            const variantContainer = document.getElementById('variant-container');
            if (selectedProduct.variaciones.length > 1) {
                document.getElementById('variant-section').classList.remove('hidden');
                variantContainer.innerHTML = selectedProduct.variaciones.map((v, i) => `
                    <button class="variant-btn ${v === selectedVariant ? 'active' : ''}" onclick="selectVariant(${i}, this)">${v.color || v.variable || 'Opc ' + (i+1)}</button>
                `).join('');
            } else {
                document.getElementById('variant-section').classList.add('hidden');
            }

            document.getElementById('modal-add-btn').onclick = () => addToCart(parseInt(document.getElementById('modal-qty-input').value));
        }

        function selectVariant(i, btn) {
            selectedVariant = selectedProduct.variaciones[i];
            updateModalUI();
        }

        function updateModalInput(v) {
            const input = document.getElementById('modal-qty-input');
            let val = parseInt(input.value) + v;
            input.value = val < 1 ? 1 : val;
        }

        function addToCart(qty) {
            const item = {
                sku: selectedVariant.sku,
                nombre: selectedProduct.nombre,
                img: selectedVariant.img,
                price: selectedVariant.price,
                qty: qty
            };
            const existing = cart.find(c => c.sku === item.sku);
            if(existing) existing.qty += qty; else cart.push(item);
            
            updateCartUI();
            closeProductModal();
            showToast("A√±adido al pedido");
        }

        function updateCartUI() {
            const count = cart.reduce((acc, item) => acc + item.qty, 0);
            document.getElementById('cart-count').innerText = count;
            
            let total = 0;
            document.getElementById('cart-items').innerHTML = cart.map((item, i) => {
                total += item.price * item.qty;
                return `
                    <div class="flex gap-3 bg-white p-3 rounded-xl border border-gray-100">
                        <img src="${item.img}" class="w-16 h-16 object-contain">
                        <div class="flex-grow">
                            <p class="font-bold text-sm text-fv-blue">${item.nombre}</p>
                            <p class="text-xs text-gray-500">Cant: ${item.qty} x ${formatMoney(item.price)}</p>
                            <p class="font-bold text-fv-blue">${formatMoney(item.price * item.qty)}</p>
                        </div>
                        <button onclick="removeFromCart(${i})" class="text-red-400 p-2"><i class="fa-solid fa-trash-can"></i></button>
                    </div>
                `;
            }).join('');
            document.getElementById('cart-total').innerText = formatMoney(total);
        }

        function removeFromCart(i) { cart.splice(i, 1); updateCartUI(); }
        function toggleCart() { document.getElementById('cart-modal').classList.toggle('hidden'); }
        function closeProductModal() { document.getElementById('product-modal').classList.add('hidden'); }
        function updatePriceLabel(v) { document.getElementById('price-label').innerText = formatMoney(parseInt(v)); }

        function sendToWhatsApp() {
            if (cart.length === 0) return;
            let msg = `üõí *PEDIDO - FORWARDER VENTURE*%0A%0AHola, deseo adquirir estos productos:%0A%0A`;
            let total = 0;
            cart.forEach(i => {
                msg += `‚Ä¢ ${i.nombre} (x${i.qty}) - ${formatMoney(i.price * i.qty)}%0A`;
                total += i.price * i.qty;
            });
            msg += `%0A*TOTAL: ${formatMoney(total)}*%0A%0AQuedo atento.`;
            window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`, '_blank');
        }

        function shareProductWhatsApp() {
            const text = `¬°Mira este producto en Forwarder Venture! \n\n*${selectedProduct.nombre}*\n${window.location.href}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            document.getElementById('toast-msg').innerText = msg;
            t.classList.replace('opacity-0', 'opacity-100');
            setTimeout(() => t.classList.replace('opacity-100', 'opacity-0'), 2000);
        }

        loadProducts();
    </script>
</body>
</html>
